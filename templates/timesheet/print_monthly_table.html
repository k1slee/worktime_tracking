<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞–±–µ–ª—å —É—á–µ—Ç–∞ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ {{ month|stringformat:"02d" }}.{{ year }} –≥.</title>
    {% load custom_filters %} 
    <style>
    /* ===== –ë–ê–ó–û–í–´–ï –ù–ê–°–¢–†–û–ô–ö–ò ===== */
    @page {
        size: A4 landscape;
        margin: 5mm;
    }
    
    body {
        font-family: 'Arial', sans-serif;
        font-size: 6.5pt;
        line-height: 1;
        margin: 0;
        padding: 0;
        color: #000000;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }
    /* ===== –®–ê–ü–ö–ê –î–û–ö–£–ú–ï–ù–¢–ê ===== */
   /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—á–∞—Ç–Ω–æ–π —Ñ–æ—Ä–º—ã */
    .header {
        position: relative;
        display: flex;
        justify-content: space-between;
        margin-bottom: 0;
        min-height: 80px; /* –£–º–µ–Ω—å—à–∏–ª–∏ –∏–∑-–∑–∞ –º–µ–Ω—å—à–∏—Ö —à—Ä–∏—Ñ—Ç–æ–≤ */
    }

    .left-section {
        width: 45%;
        padding-left: 10mm;
        padding-top: 5mm;
    }

    .right-section {
        width: 55%;
        padding-top: 6mm; /* –£–º–µ–Ω—å—à–∏–ª–∏ –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
        text-align: center;
    }

    .line-group {
        margin-bottom: 6px; /* –£–º–µ–Ω—å—à–∏–ª–∏ –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ */
    }

    .text-line {
        text-align: center;
        font-weight: bold;
        margin-bottom: 1px;
        white-space: nowrap;
    }

    .org-text {
        font-size: 11pt; /* –£–º–µ–Ω—å—à–µ–Ω–æ —Å 13pt */
    }

    .workshop-text {
        font-size: 10pt; /* –£–º–µ–Ω—å—à–µ–Ω–æ —Å 11pt */
        text-transform: uppercase;
    }

    .title-text {
        font-size: 11pt; /* –£–º–µ–Ω—å—à–µ–Ω–æ —Å 13pt */
        text-transform: uppercase;
    }

    .underline-line {
        height: 1px;
        background-color: #000;
        margin: 0 auto 1px auto;
    }

    .subtext {
        font-size: 8pt; /* –£–º–µ–Ω—å—à–µ–Ω–æ —Å 9pt */
        color: #555;
        font-style: italic;
        text-align: center;
        margin-top: 0;
    }
    .title-tight {
        position: absolute;
        left: 50%;
        bottom: -5px; /* –í—ã–¥–≤–∏–≥–∞–µ–º –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –±–ª–æ–∫–∞ –≤–Ω–∏–∑ */
        transform: translateX(-50%);
        text-align: center;
        width: 55%;
    }
    @media print {
        .org-text,
        .title-text {
            font-size: 12pt; /* –ù–µ–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –ø—Ä–∏ –ø–µ—á–∞—Ç–∏ */
        }
        
        .workshop-text {
            font-size: 11pt; /* –ù–µ–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –ø—Ä–∏ –ø–µ—á–∞—Ç–∏ */
        }
        
        .header {
            margin-bottom: 4mm;
        }
    }
    /* ===== –¢–ê–ë–õ–ò–¶–ê ===== */
    .table-container {
        width: 100%;
        overflow: visible;
    }
    
    .table {
        width: 100%;
        border-collapse: collapse;
        font-size: 6.5pt;
        page-break-inside: auto;
        table-layout: fixed;
        border: 1pt solid #000;
    }
    
    .table th, .table td {
        border: 0.5pt solid #000;
        padding: 0;
        text-align: center;
        vertical-align: middle;
        line-height: 1;
        overflow: hidden;
        font-weight: normal;
    }
    
    /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ */
    .col-number { 
        width: 6mm; 
        min-width: 6mm;
        max-width: 6mm;
    }
    
    .col-name { 
        width: 38mm; 
        text-align: left; 
        padding-left: 0.5mm !important;
        font-size: 6.5pt;
        min-width: 38mm;
        max-width: 38mm;
    }
    
    .col-position { 
        width: 29mm; 
        text-align: left; 
        padding-left: 0.5mm !important;
        min-width: 29mm;
        max-width: 29mm;
    }
    
    .col-employee-id { 
        width: 8mm !important; 
        min-width: 12mm !important;
        max-width: 12mm !important;
    }
    
    /* –ö–æ–ª–æ–Ω–∫–∏ —Å –¥–Ω—è–º–∏ - —É–∑–∫–∏–µ */
    .day-col { 
        width: 4mm !important; 
        min-width: 4mm !important;
        max-width: 4mm !important;
        padding: 0 !important;
        font-size: 6.5pt;
        height: 6mm !important;
    }
    
    .col-stats { 
        padding: 0 !important;
        font-size: 6.5pt;
        text-align: center;
        vertical-align: middle;
    }
    
    /* –í–ï–†–¢–ò–ö–ê–õ–¨–ù–´–ô –¢–ï–ö–°–¢ –í –ó–ê–ì–û–õ–û–í–ö–ê–• */
    .vertical-header {
        position: relative;
        height: 17mm !important;
        padding: 0 !important;
    }
    
    .vertical-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) rotate(-90deg);
        transform-origin: center center;
        white-space: nowrap;
        font-size: 6pt;
        line-height: 1;
        width: 17mm;
        height: 5mm;
        text-align: center;
        font-weight: normal;
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ - –î–û–õ–ñ–ù–´ –ë–´–¢–¨ –ü–û–°–õ–ï .vertical-header */
    .col-days-work { /* —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }

    .col-days-downtime { /* —Ü–µ–ª–æ—Å–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Å—Ç–æ–µ–≤ */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }

    .col-vacation { /* –æ—á–µ—Ä–µ–¥–Ω–æ–π –æ—Ç–ø—É—Å–∫ */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }

    .col-illness { /* –±–æ–ª–µ–∑–Ω—å */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }

    .col-other-absences { /* –ø—Ä–æ—á–∏–µ –Ω–µ—è–≤–∫–∏ */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }

    .col-admin-permission { /* —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏ */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }

    .col-absence { /* –ø—Ä–æ–≥—É–ª */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }

    /* –û–¢–†–ê–ë–û–¢–ê–ù–û –ß–ê–°–û–í */
    .col-total-hours { /* –≤—Å–µ–≥–æ */
        width: 15mm !important;
        min-width: 15mm !important;
        max-width: 15mm !important;
    }

    .col-weekend-hours { /* –≤—ã—Ö–æ–¥–Ω—ã–µ */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }

    .col-evening-hours { /* –≤–µ—á–µ—Ä–Ω–∏–µ */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }

    .col-night-hours { /* –Ω–æ—á–Ω—ã–µ */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }

    .col-weekend-hours2 { /* –≤—ã—Ö–æ–¥–Ω—ã–µ (–≤—Ç–æ—Ä–∞—è –∫–æ–ª–æ–Ω–∫–∞) */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }

    .col-overtime { /* —Å–≤–µ—Ä—Ö—É—Ä–æ—á–Ω–æ */
        width: 10mm !important;
        min-width: 10mm !important;
        max-width: 10mm !important;
    }
    /* –ö–æ–ª–æ–Ω–∫–∏ —á–∞—Å–æ–≤ */
    .col-hours { 
        width: 5mm !important; 
        min-width: 5mm !important;
        max-width: 5mm !important;
        padding: 0 !important;
        font-size: 6.5pt;
    }
    
    /* –í—ã—Å–æ—Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ */
    .table th[rowspan="3"] {
        height: 13.5mm !important;
        vertical-align: middle;
    }
    
    .table th[colspan]:not([rowspan]) {
        height: 4.2mm !important;
        vertical-align: middle;
        padding: 0 !important;
    }
    
    .table th[rowspan="2"]:not([rowspan="3"]) {
        height: 8.7mm !important;
        vertical-align: middle;
    }
    
    /* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç */
    .horizontal-text {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        width: 100%;
        font-size: 6.5pt;
        line-height: 1;
        text-align: center;
        padding: 0;
        font-weight: normal;
    }
    
    /* –¶–í–ï–¢–ê –î–õ–Ø –†–ê–ó–õ–ò–ß–ù–´–• –¢–ò–ü–û–í –î–ù–ï–ô */
    .weekend {
        background-color: #f0f0f0 !important;
    }
    
    /* –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ */
    .total-row {
        font-weight: bold;
    }
    
    .total-row td {
        font-weight: bold;
        text-align: left;
        padding-left: 0.5mm !important;
    }
    
    .total-row .col-stats,
    .total-row .col-hours {
        text-align: center;
        padding-left: 0 !important;
    }
    
    /* –£—Å–ª–æ–≤–Ω—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è */
    .legend {
        margin-top: 1.5mm;
        font-size: 6pt;
        border-top: 0.5pt solid #000;
        padding-top: 0.5mm;
    }
    
    .legend-title {
        font-weight: bold;
        text-align: center;
        margin-bottom: 0.3mm;
        font-size: 6.5pt;
    }
    
    .legend-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 6pt;
        margin-top: 0.3mm;
    }
    
    .legend-table td {
        border: none;
        padding: 0.1mm 0.5mm;
        vertical-align: top;
        line-height: 1.1;
        text-align: left;
    }
    
    .legend-code {
        font-weight: bold;
        text-align: center;
        width: 3.5mm;
        padding: 0.1mm !important;
    }
    
    /* –ü–æ–¥–ø–∏—Å–∏ */
    .signatures {
        margin-top: 3mm;
        display: flex;
        justify-content: space-between;
        font-size: 7pt;
        border-top: 0.5pt solid #000;
        padding-top: 1.5mm;
    }
    
    .signature-left, .signature-right {
        width: 48%;
    }
    
    .signature-left {
        text-align: left;
    }
    
    .signature-right {
        text-align: right;
    }
    
    /* –ö–Ω–æ–ø–∫–∞ –ø–µ—á–∞—Ç–∏ */
    .print-button {
        position: fixed;
        top: 10px;
        right: 10px;
        padding: 3px 6px;
        background: #4CAF50;
        color: white;
        border: none;
        border-radius: 2px;
        cursor: pointer;
        z-index: 1000;
        font-size: 7pt;
    }
    
    .print-button:hover {
        background: #45a049;
    }
    
    /* –ü–µ—á–∞—Ç—å */
    @media print {
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            font-size: 6.5pt;
        }
        
        .print-button {
            display: none;
        }
        
        .table th, .table td {
            border-color: #000 !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
        
        .weekend {
            background-color: #f0f0f0 !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    }
    
    /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è —è—á–µ–µ–∫ */
    .cell-content {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        width: 100%;
        font-size: 6.5pt;
        font-weight: normal;
    }
    
    .text-left {
        justify-content: flex-start;
        padding-left: 0.5mm;
    }
    </style>
</head>
<body>
    <div class="header">
        <!-- –õ–µ–≤—ã–π –±–ª–æ–∫ - –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û –õ–ï–í–ï–ï -->
        <div class="left-section" style="position: absolute; left: 0; width: 30%; padding-left: 2mm;">
            <div class="line-group">
                <div class="text-line org-text" style="font-size: 11pt; text-align: left;">–£–Ω–∏—Ç–∞—Ä–Ω–æ–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ "–¶–≤–µ—Ç–ª–∏—Ç"</div>
                <div class="underline-line" style="width: 80%; margin-left: 0;"></div>
                <div class="subtext" style="font-size: 8pt; text-align: left;">(–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏)</div>
            </div>
            
            {% if is_master %}
            <div class="line-group">
                <div class="text-line workshop-text" style="font-size: 10pt; text-align: left;">
                    {% if user.department %}{{ user.department.name|upper }}{% else %}(–¶–ï–• –ù–ï –£–ö–ê–ó–ê–ù){% endif %} {{ composer_fio|default:"" }}
                </div>
                <div class="underline-line" style="width: 65%; margin-left: 0;"></div>
                <div class="subtext" style="font-size: 8pt; text-align: left;">
                    <span>–¶–µ—Ö (–æ—Ç–¥–µ–ª), —É—á–∞—Å—Ç–æ–∫</span>
                    <span style="margin-left: 10px;">–º–∞—Å—Ç–µ—Ä</span>
                </div>
            </div>
            {% endif %}
        </div>
        
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–µ–ª—è -->
        <div class="title-tight">
            <div class="text-line title-text" style="font-size: 11pt; margin: 0;">
                –¢–∞–±–µ–ª—å —É—á–µ—Ç–∞ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ 
                {% if month == 1 %}–Ø–Ω–≤–∞—Ä—å{% elif month == 2 %}—Ñ–µ–≤—Ä–∞–ª—å{% elif month == 3 %}–º–∞—Ä—Ç{% elif month == 4 %}–∞–ø—Ä–µ–ª—å{% elif month == 5 %}–º–∞–π{% elif month == 6 %}–∏—é–Ω—å{% elif month == 7 %}–∏—é–ª—å{% elif month == 8 %}–∞–≤–≥—É—Å—Ç{% elif month == 9 %}—Å–µ–Ω—Ç—è–±—Ä—å{% elif month == 10 %}–æ–∫—Ç—è–±—Ä—å{% elif month == 11 %}–Ω–æ—è–±—Ä—å{% elif month == 12 %}–¥–µ–∫–∞–±—Ä—å{% endif %}
                {{ year }} –≥–æ–¥–∞
            </div>
            <div class="underline-line" style="width: 95%; height: 1.5px; margin: 1px auto 0 auto;"></div>
        </div>
    </div>
    
    <!-- ===== –¢–ê–ë–õ–ò–¶–ê ===== -->
    <div class="table-container">
        <table class="table">
            <thead>
                <!-- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ -->
                <tr>
                    <th rowspan="3" class="col-number">‚Ññ –ø/–ø</th>
                    <th rowspan="3" class="col-name"style="font-family: 'Times New Roman', serif; font-size: 11pt;"><b>–§–∞–º–∏–ª–∏—è, –ò.–û.</b></th>
                    <th rowspan="3" class="col-position"style="font-family: 'Times New Roman', serif; font-size: 8pt;"><b>–ü—Ä–æ—Ñ–µ—Å—Å–∏—è, –¥–æ–ª–∂–Ω–æ—Å—Ç—å</b></th>
                    <th rowspan="3" class="col-employee-id vertical-header"style="font-family: 'Times New Roman', serif; font-size: 7pt;"><div class="vertical-text"><b>–¢–∞–±–µ–ª—å–Ω—ã–π ‚Ññ</b></div></th>
                    
                    <!-- –ß–∏—Å–ª–∞ –º–µ—Å—è—Ü–∞ -->
                    <th colspan="{{ days|length }}" style="text-align: center; height: 4.2mm !important; font-size: 6.5pt; font-weight: normal;">–ß–∏—Å–ª–∞ –º–µ—Å—è—Ü–∞</th>
                    
                    <!-- –î–Ω–∏ —è–≤–æ–∫ -->
                    <th colspan="2" style="text-align: center; height: 4.2mm !important; font-size: 6.5pt; font-weight: normal;">–î–Ω–∏ —è–≤–æ–∫</th>
                    
                    <!-- –î–Ω–∏ –Ω–µ—è–≤–æ–∫ -->
                    <th colspan="6" style="text-align: center; height: 4.2mm !important; font-size: 6.5pt; font-weight: normal;">–î–Ω–∏ –Ω–µ—è–≤–æ–∫</th>
                    
                    <!-- –û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —á–∞—Å–æ–≤ -->
                    <th colspan="6" style="text-align: center; height: 4.2mm !important; font-size: 6.5pt; font-weight: normal;">–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —á–∞—Å–æ–≤</th>
                </tr>
                
                <!-- –¢—Ä–µ—Ç—å—è —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (–¥–µ—Ç–∞–ª—å–Ω—ã–µ) -->
                <tr>
                <!-- –î–Ω–∏ –º–µ—Å—è—Ü–∞ -->
                {% for day in days %}
                <th class="day-col {% if weekend_days|get_item:day %}weekend{% endif %}" style="height: 17mm !important;">
                    <div class="horizontal-text" style="display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; font-size: 5pt;">{{ day }}</div>
                </th>
                {% endfor %}
                
                <!-- –î–Ω–∏ —è–≤–æ–∫ -->
                <th class="col-stats vertical-header col-days-work" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π<br>—Ä–∞–±–æ—Ç—ã</div>
                    </div>
                </th>
                <th class="col-stats vertical-header col-days-downtime" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">—Ü–µ–ª–æ—Å–º–µ–Ω–Ω—ã—Ö<br>–ø—Ä–æ—Å—Ç–æ–µ–≤</div>
                    </div>
                </th>
                
                <!-- –î–Ω–∏ –Ω–µ—è–≤–æ–∫ -->
                <th class="col-stats vertical-header col-vacation" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">–æ—á–µ—Ä–µ–¥–Ω–æ–π<br>–æ—Ç–ø—É—Å–∫</div>
                    </div>
                </th>
                <th class="col-stats vertical-header col-illness" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">–±–æ–ª–µ–∑–Ω—å</div>
                    </div>
                </th>
                <th class="col-stats vertical-header col-other-absences" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">–ø—Ä–æ—á–∏–µ –Ω–µ—è–≤–∫–∏,<br>—Ä–∞–∑—Ä–µ—à.–∑–∞–∫–æ–Ω.</div>
                    </div>
                </th>
                <th class="col-stats vertical-header col-admin-permission" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è<br>–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏</div>
                    </div>
                </th>
                <th class="col-stats vertical-header col-absence" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">–ø—Ä–æ–≥—É–ª</div>
                    </div>
                </th>
                <th class="col-stats vertical-header" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">–∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏</div>
                    </div>
                </th>
                
                <!-- –û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —á–∞—Å–æ–≤ -->
                <th class="col-stats col-total-hours vertical-header" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">–≤—Å–µ–≥–æ</div>
                    </div>
                </th>
                <th class="col-stats col-weekend-hours vertical-header" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">–≤—ã—Ö–æ–¥–Ω—ã–µ</div>
                    </div>
                </th>
                <th class="col-stats col-evening-hours vertical-header" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">–≤–µ—á–µ—Ä–Ω–∏–µ</div>
                    </div>
                </th>
                <th class="col-stats col-night-hours vertical-header" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">–Ω–æ—á–Ω—ã–µ</div>
                    </div>
                </th>
                <th class="col-stats col-weekend-hours2 vertical-header" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">–≤—ã—Ö–æ–¥–Ω—ã–µ</div>
                    </div>
                </th>
                <th class="col-stats col-overtime vertical-header" style="height: 17mm !important; position: relative;">
                    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                        <div style="transform: rotate(-90deg); transform-origin: center; font-size: 5pt; text-align: center; line-height: 1.1; white-space: nowrap;">—Å–≤–µ—Ä—Ö—É—Ä–æ—á–Ω–æ</div>
                    </div>
                </th>
            </tr>
            </thead>
            
            <tbody>
                {% for row in table_data %}
                <tr>
                    <td class="col-number">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ forloop.counter }}</div>
                    </td>
                    <td class="col-name">
                        <div class="cell-content text-left">{{ row.formatted_fio|default:row.employee.full_name }}</div>
                    </td>
                    <td class="col-position">
                        <div class="cell-content text-left">{{ row.employee.position|default:"-" }}</div>
                    </td>
                    <td class="col-employee-id">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;"><b>{{ row.employee.employee_id|default:row.employee.id }}</b></div>
                    </td>
                    
                    <!-- –î–Ω–∏ –º–µ—Å—è—Ü–∞ -->
                    {% for day_data in row.days %}
                    <td class="day-col {% if weekend_days|get_item:day_data.day %}weekend{% endif %}">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ day_data.display_value| only_number}}</div>
                    </td>
                    {% endfor %}
                    
                    <!-- –î–Ω–∏ —è–≤–æ–∫ -->
                    <td class="col-stats col-days-work">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.attendance_days }}</div>
                    </td>
                    <td class="col-stats col-days-downtime">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.downtime_days }}</div>
                    </td>

                    <!-- –î–Ω–∏ –Ω–µ—è–≤–æ–∫ -->
                    <td class="col-stats col-vacation">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.vacation_days }}</div>
                    </td>
                    <td class="col-stats col-illness">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.illness_days }}</div>
                    </td>
                    <td class="col-stats col-other-absences">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.other_absence_days|default:"0" }}</div>
                    </td>
                    <td class="col-stats col-admin-permission">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.admin_permission_days|default:"0" }}</div>
                    </td>
                    <td class="col-stats col-absence">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.absence_days }}</div>
                    </td>
                    <td class="col-stats">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.business_trip_days|default:"0" }}</div>
                    </td>

                    <!--–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —á–∞—Å–æ–≤-->
                    <td class="col-stats col-total-hours">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.total_hours}}</div>
                    </td>
                    <td class="col-stats col-weekend-hours">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.weekend_hours|floatformat:0|default:"0" }}</div>
                    </td>
                    <td class="col-stats col-evening-hours">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.evening_hours|floatformat:0|default:"0" }}</div>
                    </td>
                    <td class="col-stats col-night-hours">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.night_hours|floatformat:0|default:"0" }}</div>
                    </td>
                    <td class="col-stats col-weekend-hours2">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.weekend_hours|floatformat:0|default:"0" }}</div>
                    </td>
                    <td class="col-stats col-overtime">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ row.overtime_hours|floatformat:0|default:"0" }}</div>
                    </td>
                </tr>
                {% endfor %}
                
                <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ -->
                <tr class="total-row">
                    <td colspan="{{ days|length|add:'4' }}">–ò–¢–û–ì–û</td>
                    <td class="col-stats col-days-work">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ table_data|sum_attr_int:"attendance_days"}}</div>
                    </td>
                    
                    <!-- –ü–£–°–¢–´–ï –Ø–ß–ï–ô–ö–ò –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ "–î–Ω–∏ —è–≤–æ–∫" –∏ "–î–Ω–∏ –Ω–µ—è–≤–æ–∫" -->
                    <td colspan="7"></td>
                    
                    <!-- –ö–æ–ª–æ–Ω–∫–∞ "–≤—Å–µ–≥–æ" -->
                    <td class="col-stats col-total-hours">
                        <div class="cell-content" style="font-family: 'Times New Roman', serif; font-size: 9pt;">{{ table_data|sum_attr_any:"total_hours"}}</div>
                    </td>
                    
                    <!-- –ü–£–°–¢–´–ï –Ø–ß–ï–ô–ö–ò –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ "–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —á–∞—Å–æ–≤" -->
                    <td colspan="5"></td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <!-- ===== –£–°–õ–û–í–ù–´–ï –û–ë–û–ó–ù–ê–ß–ï–ù–ò–Ø ===== -->
    <div class="legend">
        <div class="legend-title">–£–°–õ–û–í–ù–´–ï –û–ë–û–ó–ù–ê–ß–ï–ù–ò–Ø</div>
        <table class="legend-table">
            <tr>
                <td>–í—ã—Ö–æ–¥–Ω—ã–µ –∏ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –¥–Ω–∏</td>
                <td class="legend-code">–í</td>
                <td>–õ—å–≥–æ—Ç–Ω—ã–µ —á–∞—Å—ã –∫–æ—Ä–º—è—â–∏—Ö –º–∞—Ç–µ—Ä–µ–π</td>
                <td class="legend-code">–ú</td>
                <td>–ü—Ä–æ–≥—É–ª—ã</td>
                <td class="legend-code">–ü</td>
            </tr>
            <tr>
                <td>–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏ —Å–ª—É–∂–µ–±–Ω—ã–µ</td>
                <td class="legend-code">–ö</td>
                <td>–ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤ –¥–æ 18 –ª–µ—Ç</td>
                <td class="legend-code">–õ</td>
                <td>–û–ø–æ–∑–¥–∞–Ω–∏—è –∏ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —É—Ö–æ–¥ —Å —Ä–∞–±–æ—Ç—ã</td>
                <td class="legend-code">–ù</td>
            </tr>
            <tr>
                <td>–û—á–µ—Ä–µ–¥–Ω—ã–µ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–ø—É—Å–∫–∞</td>
                <td class="legend-code">–û</td>
                <td>–õ—å–≥–æ—Ç–Ω—ã–µ —á–∞—Å—ã —Ä–∞–±–æ—á–∏—Ö —Å –≤—Ä–µ–¥–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏</td>
                <td class="legend-code">–î</td>
                <td>–ù–µ—è–≤–∫–∏, —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∑–∞–∫–æ–Ω–æ–º (–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–æ—Å.–æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π)</td>
                <td class="legend-code">–ì</td>
            </tr>
            <tr>
                <td>–ù–µ—Ç—Ä—É–¥–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (–±–æ–ª–µ–∑–Ω—å, –∫–∞—Ä–∞–Ω—Ç–∏–Ω –∏ —Ç.–ø.)</td>
                <td class="legend-code">–ë</td>
                <td>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ —Å–ø—Ä–∞–≤–∫–µ</td>
                <td class="legend-code">–û–°</td>
                <td>–ù–µ—è–≤–∫–∏ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏</td>
                <td class="legend-code">–ê</td>
            </tr>
            <tr>
                <td>–û—Ç–ø—É—Å–∫ –ø–æ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Ä–æ–¥–∞–º</td>
                <td class="legend-code">–†</td>
                <td>–ü—Ä–æ—Å—Ç–æ–∏ —Ü–µ–ª–æ—Å–º–µ–Ω–Ω—ã–µ</td>
                <td class="legend-code">–¶–ü</td>
                <td>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–≤–æ–±–æ–¥–Ω—ã–π –æ—Ç —Ä–∞–±–æ—Ç—ã –¥–µ–Ω—å –º–∞—Ç–µ—Ä–∏ (–æ—Ç—Ü–∞)</td>
                <td class="legend-code">–î–ú</td>
            </tr>
            <tr>
                <td>–°–æ—Ü–∏–∞–ª—å–Ω—ã–π –æ—Ç–ø—É—Å–∫ –ø–æ —É—Ö–æ–¥—É –∑–∞ —Ä–µ–±–µ–Ω–∫–æ–º –¥–æ 3 –ª–µ—Ç</td>
                <td class="legend-code">–û–ñ</td>
                <td>–ü—Ä–æ—Å—Ç–æ–∏ –≤–Ω—É—Ç—Ä–∏—Å–º–µ–Ω–Ω—ã–µ</td>
                <td class="legend-code">–ß</td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    
    <!-- ===== –ü–û–î–ü–ò–°–ò ===== -->
    <div class="signatures">
        <div class="signature-left">
            –ù–∞—á–∞–ª—å–Ω–∏–∫ —Ü–µ—Ö–∞ ______________ 
            {{ shop_chief_name|default:"–°.–í. –ï—Ñ—Ä–µ–º–µ–Ω–∫–æ" }}
        </div>
        <div class="signature-right">
            –°–æ—Å—Ç–∞–≤–∏–ª______________________ 
            {{ composer_fio }}
        </div>
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—á–∞—Ç–∏ -->
    <button onclick="window.print()" class="print-button">
        üñ®Ô∏è –ü–µ—á–∞—Ç—å
    </button>
</body>
</html>
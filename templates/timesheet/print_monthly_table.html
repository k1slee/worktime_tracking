<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞–±–µ–ª—å —É—á–µ—Ç–∞ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ {{ month|stringformat:"02d" }}.{{ year }} –≥.</title>
    <style>
        /* ===== –ë–ê–ó–û–í–´–ï –ù–ê–°–¢–†–û–ô–ö–ò ===== */
        @page {
            size: A4 landscape;
            margin: 5mm;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            font-size: 6pt;
            line-height: 1;
            margin: 0;
            padding: 0;
        }
        
        /* ===== –®–ê–ü–ö–ê –î–û–ö–£–ú–ï–ù–¢–ê ===== */
        .header {
            width: 100%;
            margin-bottom: 2mm;
        }
        
        .org-name {
            font-size: 8pt;
            font-weight: bold;
            margin-bottom: 0.5mm;
        }
        
        .org-details {
            font-size: 6pt;
            color: #666;
            margin-bottom: 1mm;
        }
        
        .workshop-master-line {
            font-size: 8pt;
            font-weight: bold;
            text-transform: uppercase;
            margin-bottom: 0.5mm;
        }
        
        .workshop-details {
            font-size: 6pt;
            color: #666;
            margin-bottom: 2mm;
        }
        
        .main-title {
            text-align: center;
            font-size: 12pt;
            font-weight: bold;
            text-transform: uppercase;
            margin-bottom: 2mm;
            padding-bottom: 0.5mm;
            border-bottom: 1pt solid #000;
        }
        
        /* ===== –¢–ê–ë–õ–ò–¶–ê ===== */
        .table {
            width: 100%;
            border-collapse: collapse;
            font-size: 6pt;
            page-break-inside: auto;
            table-layout: fixed;
        }
        
        .table th, .table td {
            border: 0.5pt solid #000;
            padding: 0.1mm;
            text-align: center;
            vertical-align: middle;
            height: 6mm !important;
            min-height: 6mm !important;
            max-height: 6mm !important;
            line-height: 1;
            overflow: hidden;
        }
        
        /* –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã */
        .table th {
            background-color: #f0f0f0;
            font-weight: bold;
        }
        
        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ */
        .col-number { 
            width: 8mm; 
            font-weight: bold; 
        }
        
        .col-name { 
            width: 45mm; 
            text-align: left; 
            padding-left: 0.5mm !important;
            font-size: 6.5pt;
        }
        
        .col-position { 
            width: 35mm; 
            text-align: left; 
            padding-left: 0.5mm !important;
        }
        
        .col-employee-id { 
            width: 15mm; 
            font-weight: bold; 
        }
        
        /* –ö–æ–ª–æ–Ω–∫–∏ –¥–Ω–µ–π - 4–º–º —à–∏—Ä–∏–Ω–∞ */
        .day-col { 
            width: 4mm !important; 
            min-width: 4mm !important;
            max-width: 4mm !important;
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ - 8–º–º —à–∏—Ä–∏–Ω–∞ */
        .col-worked-days, .col-stats, .col-total-hours, .col-subhours {
            width: 8mm !important;
            min-width: 8mm !important;
            max-width: 8mm !important;
        }
        
        /* –¶–≤–µ—Ç–∞ –∫–æ–ª–æ–Ω–æ–∫ */
        .col-worked-days {
            background-color: #ffffcc !important; /* –ñ–µ–ª—Ç—ã–π */
        }
        
        .col-stats {
            background-color: #f5f5f5 !important; /* –°–µ—Ä—ã–π */
        }
        
        .col-total-hours {
            background-color: #ffffcc !important; /* –ñ–µ–ª—Ç—ã–π */
        }
        
        .col-subhours {
            background-color: #f5f5f5 !important; /* –°–µ—Ä—ã–π */
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã—Ö–æ–¥–Ω—ã—Ö */
        .weekend-day { 
            background-color: #fff0f0 !important; 
        }
        
        .weekend-cell { 
            background-color: #fff8f8 !important; 
        }
        
        /* –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ */
        .total-row td {
            font-weight: bold;
            background-color: #e8e8e8 !important;
        }
        
        /* –£—Å–ª–æ–≤–Ω—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è */
        .legend-container {
            margin-top: 2mm;
            font-size: 5.5pt;
            border-top: 0.5pt solid #ccc;
            padding-top: 0.5mm;
        }
        
        .legend-title {
            font-weight: bold;
            margin-bottom: 0.5mm;
            text-align: center;
            font-size: 6pt;
        }
        
        .legend-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0.5mm;
        }
        
        .legend-table td {
            padding: 0.2mm 0.5mm;
            vertical-align: top;
            border: none;
            text-align: left;
            width: 33.33%;
        }
        
        .legend-code {
            font-weight: bold;
            width: 5mm;
            text-align: center;
        }
        
        /* –ü–æ–¥–ø–∏—Å–∏ */
        .signatures {
            margin-top: 5mm;
            display: flex;
            justify-content: space-between;
            font-size: 7pt;
        }
        
        .signature-left, .signature-right {
            width: 45%;
        }
        
        .signature-line {
            margin-top: 12mm;
            border-top: 0.5pt solid #000;
            width: 50mm;
        }
        
        /* –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        .page-number {
            position: fixed;
            bottom: 3mm;
            right: 8mm;
            font-size: 6pt;
            color: #666;
        }
        
        /* –°–∫—Ä—ã—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏ –ø–µ—á–∞—Ç–∏ */
        @media print {
            .no-print { display: none !important; }
            body { margin: 0; padding: 0; }
            .table th, .table td { border-color: #000 !important; }
        }
    </style>
</head>
<body>
    <!-- ===== –®–ê–ü–ö–ê –î–û–ö–£–ú–ï–ù–¢–ê ===== -->
    <div class="header">
        <div class="org-name">–£–Ω–∏—Ç–∞—Ä–Ω–æ–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ "–¶–≤–µ—Ç–ª–∏—Ç"</div>
        <div class="org-details">(–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏)</div>
        
        <div class="workshop-master-line">{{ workshop_name }} {{ master_name }}</div>
        <div class="workshop-details">–¶–µ—Ö (–æ—Ç–¥–µ–ª), —É—á–∞—Å—Ç–æ–∫</div>
        
        <div class="main-title">
            –¢–∞–±–µ–ª—å —É—á–µ—Ç–∞ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ 
            {% if month == 1 %}—è–Ω–≤–∞—Ä—å{% elif month == 2 %}—Ñ–µ–≤—Ä–∞–ª—å{% elif month == 3 %}–º–∞—Ä—Ç{% elif month == 4 %}–∞–ø—Ä–µ–ª—å{% elif month == 5 %}–º–∞–π{% elif month == 6 %}–∏—é–Ω—å{% elif month == 7 %}–∏—é–ª—å{% elif month == 8 %}–∞–≤–≥—É—Å—Ç{% elif month == 9 %}—Å–µ–Ω—Ç—è–±—Ä—å{% elif month == 10 %}–æ–∫—Ç—è–±—Ä—å{% elif month == 11 %}–Ω–æ—è–±—Ä—å{% elif month == 12 %}–¥–µ–∫–∞–±—Ä—å{% endif %}
            {{ year }} –≥–æ–¥–∞
        </div>
    </div>
    
    <!-- ===== –¢–ê–ë–õ–ò–¶–ê ===== -->
    <table class="table">
        <thead>
            <!-- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ -->
            <tr>
                <th rowspan="2" class="col-number">‚Ññ –ø/–ø</th>
                <th rowspan="2" class="col-name">–§–∞–º–∏–ª–∏—è, –ò.–û.</th>
                <th rowspan="2" class="col-position">–ü—Ä–æ—Ñ–µ—Å—Å–∏—è, –¥–æ–ª–∂–Ω–æ—Å—Ç—å</th>
                <th rowspan="2" class="col-employee-id">–¢–∞–±–µ–ª—å–Ω—ã–π ‚Ññ</th>
                
                <!-- –ß–∏—Å–ª–∞ –º–µ—Å—è—Ü–∞ –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è —è—á–µ–π–∫–∞ -->
                <th colspan="{{ days|length }}" style="text-align: center;">
                    –ß–∏—Å–ª–∞ –º–µ—Å—è—Ü–∞
                </th>
                
                <!-- –î–Ω–∏ —è–≤–æ–∫ -->
                <th colspan="7" style="text-align: center;">
                    –î–Ω–∏ —è–≤–æ–∫
                </th>
                
                <!-- –î–Ω–∏ –Ω–µ—è–≤–æ–∫ -->
                <th colspan="7" style="text-align: center;">
                    –î–Ω–∏ –Ω–µ—è–≤–æ–∫
                </th>
                
                <!-- –û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —á–∞—Å–æ–≤ -->
                <th colspan="6" style="text-align: center;">
                    –û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —á–∞—Å–æ–≤
                </th>
            </tr>
            
            <!-- –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ -->
            <tr>
                <!-- –î–Ω–∏ –º–µ—Å—è—Ü–∞ -->
                {% for day in days %}
                {% with day_date=year|stringformat:"s"|add:"-"|add:month|stringformat:"02d"|add:"-"|add:day|stringformat:"02d" %}
                <th class="day-col {% if day_date|date:'w' in '06' %}weekend-day{% endif %}">
                    {{ day }}
                </th>
                {% endwith %}
                {% endfor %}
                
                <!-- –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π —è–≤–æ–∫ -->
                <th class="col-worked-days">—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã</th>
                <th class="col-stats">—Ü–µ–ª–æ—Å–º–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Å—Ç–æ–µ–≤</th>
                <th class="col-stats">–æ—á–µ—Ä–µ–¥–Ω–æ–π –æ—Ç–ø—É—Å–∫</th>
                <th class="col-stats">–±–æ–ª–µ–∑–Ω—å</th>
                <th class="col-stats">–ø—Ä–æ—á–∏–µ –Ω–µ—è–≤–∫–∏, —Ä–∞–∑—Ä–µ—à.–∑–∞–∫–æ–Ω.</th>
                <th class="col-stats">—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                <th class="col-stats">–ø—Ä–æ–≥—É–ª</th>
                
                <!-- –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∏ —á–∞—Å–æ–≤ -->
                <th class="col-total-hours">–≤—Å–µ–≥–æ</th>
                <th class="col-subhours">–°–ü</th>
                <th class="col-subhours">–≤–µ—á–µ—Ä–Ω–∏–µ</th>
                <th class="col-subhours">–Ω–æ—á–Ω—ã–µ</th>
                <th class="col-subhours">–≤—ã—Ö–æ–¥–Ω—ã–µ</th>
                <th class="col-subhours">—Å–≤–µ—Ä—Ö—É—Ä–æ—á–Ω–æ</th>
            </tr>
        </thead>
        
        <tbody>
            {% for row in table_data %}
            <tr>
                <td class="col-number">{{ forloop.counter }}</td>
                <td class="col-name">{{ row.employee.full_name }}</td>
                <td class="col-position">{{ row.employee.position|default:"-" }}</td>
                <td class="col-employee-id">{{ row.employee.employee_id }}</td>
                
                <!-- –î–Ω–∏ –º–µ—Å—è—Ü–∞ -->
                {% for day_data in row.days %}
                {% with day_date=year|stringformat:"s"|add:"-"|add:month|stringformat:"02d"|add:"-"|add:day_data.day|stringformat:"02d" %}
                <td class="day-col {% if day_date|date:'w' in '06' %}weekend-cell{% endif %}">
                    {{ day_data.display_value|default:"" }}
                </td>
                {% endwith %}
                {% endfor %}
                
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–Ω—è–º -->
                <td class="col-worked-days">{{ row.attendance_days }}</td>
                <td class="col-stats">{{ row.downtime_days }}</td>
                <td class="col-stats">{{ row.vacation_days }}</td>
                <td class="col-stats">{{ row.illness_days }}</td>
                <td class="col-stats">{{ row.other_absence_days|default:"0" }}</td>
                <td class="col-stats">{{ row.admin_permission_days|default:"0" }}</td>
                <td class="col-stats">{{ row.absence_days }}</td>
                
                <!-- –ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã -->
                <td class="col-total-hours">{{ row.total_hours }}</td>
                <td class="col-subhours">{{ row.sp_hours|default:"" }}</td>
                <td class="col-subhours">{{ row.evening_hours }}</td>
                <td class="col-subhours">{{ row.night_hours }}</td>
                <td class="col-subhours">{{ row.weekend_hours }}</td>
                <td class="col-subhours">{{ row.overtime_hours }}</td>
            </tr>
            {% endfor %}
            
            <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ -->
            <tr class="total-row">
                <td colspan="{{ days|length|add:'4' }}">–ò–¢–û–ì–û</td>
                <td>{{ total_attendance_days|default:"0" }}</td>
                <td>{{ total_downtime_days|default:"0" }}</td>
                <td>{{ total_vacation_days|default:"0" }}</td>
                <td>{{ total_illness_days|default:"0" }}</td>
                <td>{{ total_other_absence_days|default:"0" }}</td>
                <td>{{ total_admin_permission_days|default:"0" }}</td>
                <td>{{ total_absence_days|default:"0" }}</td>
                <td>{{ total_hours|default:"0" }}</td>
                <td>{{ total_sp_hours|default:"" }}</td>
                <td>{{ total_evening_hours|default:"0" }}</td>
                <td>{{ total_night_hours|default:"0" }}</td>
                <td>{{ total_weekend_hours|default:"0" }}</td>
                <td>{{ total_overtime_hours|default:"0" }}</td>
            </tr>
        </tbody>
    </table>
    
    <!-- ===== –£–°–õ–û–í–ù–´–ï –û–ë–û–ó–ù–ê–ß–ï–ù–ò–Ø ===== -->
    <div class="legend-container">
        <div class="legend-title">–£–°–õ–û–í–ù–´–ï –û–ë–û–ó–ù–ê–ß–ï–ù–ò–Ø</div>
        <table class="legend-table">
            <tr>
                <td>–í—ã—Ö–æ–¥–Ω—ã–µ –∏ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –¥–Ω–∏</td>
                <td class="legend-code">–í</td>
                <td>–õ—å–≥–æ—Ç–Ω—ã–µ —á–∞—Å—ã –∫–æ—Ä–º—è—â–∏—Ö –º–∞—Ç–µ—Ä–µ–π</td>
                <td class="legend-code">–ú</td>
                <td>–ü—Ä–æ–≥—É–ª—ã</td>
                <td class="legend-code">–ü</td>
            </tr>
            <tr>
                <td>–ö–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∏ —Å–ª—É–∂–µ–±–Ω—ã–µ</td>
                <td class="legend-code">–ö</td>
                <td>–ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤ –¥–æ 18 –ª–µ—Ç</td>
                <td class="legend-code">–õ</td>
                <td>–û–ø–æ–∑–¥–∞–Ω–∏—è –∏ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —É—Ö–æ–¥ —Å —Ä–∞–±–æ—Ç—ã</td>
                <td class="legend-code">–ù</td>
            </tr>
            <tr>
                <td>–û—á–µ—Ä–µ–¥–Ω—ã–µ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–ø—É—Å–∫–∞</td>
                <td class="legend-code">–û</td>
                <td>–õ—å–≥–æ—Ç–Ω—ã–µ —á–∞—Å—ã —Ä–∞–±–æ—á–∏—Ö —Å –≤—Ä–µ–¥–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏</td>
                <td class="legend-code">–î</td>
                <td>–ù–µ—è–≤–∫–∏, —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∑–∞–∫–æ–Ω–æ–º (–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≥–æ—Å.–æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π)</td>
                <td class="legend-code">–ì</td>
            </tr>
            <tr>
                <td>–ù–µ—Ç—Ä—É–¥–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (–±–æ–ª–µ–∑–Ω—å, –∫–∞—Ä–∞–Ω—Ç–∏–Ω –∏ —Ç.–ø.)</td>
                <td class="legend-code">–ë</td>
                <td>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ —Å–ø—Ä–∞–≤–∫–µ</td>
                <td class="legend-code">–û–°</td>
                <td>–ù–µ—è–≤–∫–∏ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏</td>
                <td class="legend-code">–ê</td>
            </tr>
            <tr>
                <td>–û—Ç–ø—É—Å–∫ –ø–æ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Ä–æ–¥–∞–º</td>
                <td class="legend-code">–†</td>
                <td>–ü—Ä–æ—Å—Ç–æ–∏ —Ü–µ–ª–æ—Å–º–µ–Ω–Ω—ã–µ</td>
                <td class="legend-code">–¶–ü</td>
                <td>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–≤–æ–±–æ–¥–Ω—ã–π –æ—Ç —Ä–∞–±–æ—Ç—ã –¥–µ–Ω—å –º–∞—Ç–µ—Ä–∏ (–æ—Ç—Ü–∞)</td>
                <td class="legend-code">–î–ú</td>
            </tr>
            <tr>
                <td>–°–æ—Ü–∏–∞–ª—å–Ω—ã–π –æ—Ç–ø—É—Å–∫ –ø–æ —É—Ö–æ–¥—É –∑–∞ —Ä–µ–±–µ–Ω–∫–æ–º –¥–æ 3 –ª–µ—Ç</td>
                <td class="legend-code">–û–ñ</td>
                <td>–ü—Ä–æ—Å—Ç–æ–∏ –≤–Ω—É—Ç—Ä–∏—Å–º–µ–Ω–Ω—ã–µ</td>
                <td class="legend-code">–ß</td>
                <td></td>
                <td></td>
            </tr>
        </table>
    </div>
    
    <!-- ===== –ü–û–î–ü–ò–°–ò ===== -->
    <div class="signatures">
        <div class="signature-left">
            –ù–∞—á–∞–ª—å–Ω–∏–∫ —Ü–µ—Ö–∞ ______________ –ê.–ì. –õ–∞–ø–∏—Ü–∫–∏–π
        </div>
        <div class="signature-right">
            –°–æ—Å—Ç–∞–≤–∏–ª______________________ {{ master_name }}
        </div>
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—á–∞—Ç–∏ (–Ω–µ –ø–µ—á–∞—Ç–∞–µ—Ç—Å—è) -->
    <button onclick="window.print()" class="no-print" style="position: fixed; top: 5px; right: 5px; padding: 3px 6px; background: #4CAF50; color: white; border: none; cursor: pointer; z-index: 1000; font-size: 8pt;">
        üñ®Ô∏è –ü–µ—á–∞—Ç—å
    </button>
    
    <!-- –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <div class="page-number">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1</div>
</body>
</html>